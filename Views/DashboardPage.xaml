<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:components="clr-namespace:SillowApp.Components"
             x:Class="SillowApp.Views.DashboardPage"
             xmlns:vm="clr-namespace:SillowApp.ViewModels"
             Title="Dashboard"
             BackgroundColor="#101728">

    <Grid x:Name="MainGrid">
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="*"/>
        </Grid.ColumnDefinitions>

        <ScrollView x:Name="DashboardContent" Grid.Column="0">
            <VerticalStackLayout Spacing="28" Padding="20">

                <VerticalStackLayout>
                    <Label x:Name="PageTitle" Text="{Binding Source={x:Static vm:DashboardViewModel.UserName}, StringFormat='Welcome back, {0}'}"
                           FontSize="32" TextColor="White" FontAttributes="Bold" />
                    <Label>
                        <Label.Text>
                            <MultiBinding StringFormat="{}{0} â€¢ {1}">
                                <Binding Source="{x:Static vm:DashboardViewModel.BusinessName}"/>
                                <Binding Path="CurrentDate"/>
                            </MultiBinding>
                        </Label.Text>
                        <Label.TextColor>
                            <Color>#94a3b8</Color>
                        </Label.TextColor>
                        <Label.FontSize>
                            <x:Double>14</x:Double>
                        </Label.FontSize>
                    </Label>
                </VerticalStackLayout>

                <HorizontalStackLayout Spacing="12">
                    <Button x:Name="JobButton" Text="View Jobs" TextColor="White" BackgroundColor="#f59e0b" CornerRadius="8" FontAttributes="Bold" Padding="16,10" Clicked="JobButton_Clicked"/>
                    <Button x:Name="CRMButton" Text="Add Client" TextColor="White" BackgroundColor="#22c55e" CornerRadius="8" FontAttributes="Bold" Padding="16,10" Clicked="CRMButton_Clicked"/>
                </HorizontalStackLayout>

                <Grid ColumnDefinitions="*,*,*" RowDefinitions="Auto,Auto" ColumnSpacing="10" RowSpacing="10">
                    <Frame BackgroundColor="#1e293b" CornerRadius="16" HasShadow="True" Padding="16">
                        <Grid HorizontalOptions="Start" RowDefinitions="40,20,50">
                            <Label Grid.Row="0" Text="ðŸ“‹" FontSize="28" TextColor="#60a5fa" />
                            <Label Grid.Row="1" Text="Total Booked Jobs" TextColor="#94a3b8" FontSize="12"/>
                            <Label x:Name="TotalJobsLabel" Grid.Row="2" Text="0" TextColor="White" FontSize="24" FontAttributes="Bold"/>
                        </Grid>
                    </Frame>

                    <Frame Grid.Column="1" BackgroundColor="#1e293b" CornerRadius="16" HasShadow="True" Padding="16">
                        <Grid HorizontalOptions="Start" RowDefinitions="40,20,50">
                            <Label Grid.Row="0" Text="ðŸ”„" FontSize="28" TextColor="#fb923c"/>
                            <Label Grid.Row="1" Text="Returns" TextColor="#94a3b8" FontSize="12"/>
                            <Label x:Name="ReturnVisitsLabel" Grid.Row="2" Text="0" TextColor="White" FontSize="24" FontAttributes="Bold"/>
                        </Grid>
                    </Frame>

                    <Frame Grid.Column="2" BackgroundColor="#1e293b" CornerRadius="16" HasShadow="True" Padding="16">
                        <Grid HorizontalOptions="Start" RowDefinitions="40,20,50">
                            <Label Grid.Row="0" Text="âœ…" FontSize="28" TextColor="#4ade80"/>
                            <Label Grid.Row="1" Text="Completed Jobs" TextColor="#94a3b8" FontSize="12"/>
                            <Label x:Name="CompletedJobsLabel" Grid.Row="2" Text="0" TextColor="White" FontSize="24" FontAttributes="Bold"/>
                        </Grid>
                    </Frame>
                </Grid>

                <Frame BackgroundColor="#1e293b" CornerRadius="16" Padding="16" HasShadow="True" Margin="0, -10, 0, 0">
                    <VerticalStackLayout>
                        <Grid ColumnDefinitions="Auto, * , Auto" VerticalOptions="Center">
                            <Label Text="ðŸ·ï¸" FontSize="20" TextColor="#fbbf24"/>
                            <Label Text="Recent Jobs" FontSize="18" TextColor="White" FontAttributes="Bold" Grid.Column="1" Margin="8,0,0,0"/>
                            <Label x:Name="ViewAllLabel" Text="View All" TextColor="#38bdf8" FontSize="14" Grid.Column="2">
                                <Label.GestureRecognizers>
                                    <TapGestureRecognizer Tapped="ViewAllLabel_Tapped"/>
                                </Label.GestureRecognizers>
                            </Label>
                        </Grid>
                        <Label x:Name="RecentJobLabel" Text="No recent jobs." TextColor="#94a3b8" Margin="0,12,0,0"/>
                    </VerticalStackLayout>
                </Frame>

                <Frame BackgroundColor="#1e293b" CornerRadius="16" Padding="16" HasShadow="True">
                    <VerticalStackLayout>
                        <Grid ColumnDefinitions="Auto,*" VerticalOptions="Center">
                            <Label Text="ðŸ“…" FontSize="20" TextColor="#fbbf24"/>
                            <Label Text="Upcoming Jobs" FontSize="18" TextColor="White" FontAttributes="Bold" Grid.Column="1" Margin="8,0,0,0"/>
                        </Grid>
                        <Label x:Name="UpcomingJobLabel" Text="No upcoming jobs." TextColor="#94a3b8" Margin="0,12,0,0"/>
                    </VerticalStackLayout>
                </Frame>
            </VerticalStackLayout>
        </ScrollView>

        <components:NavMenu x:Name="NavMenuComponent" 
                            Grid.Column="0"
                            WidthRequest="200"
                            HorizontalOptions="Start"
                            ZIndex="10"/>

        <Button x:Name="HamburgerButton" Text="â˜°" Clicked="HamburgerButton_Clicked" 
                HorizontalOptions="Start" VerticalOptions="Start" Margin="15" WidthRequest="50" HeightRequest="50"  
                BackgroundColor="#1e293b" CornerRadius="8" TextColor="White" FontSize="32" FontAttributes="Bold"
                Padding="0" ZIndex="100" />
    </Grid>
</ContentPage>